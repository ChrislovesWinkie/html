<!DOCTYPE html>
<html>
<head>
  <title>Voice Recognition</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.27.2/axios.min.js"></script>
</head>
<body>
  <h1>Voice Recognition</h1>
  <button onclick="startVoiceInput()">Start Voice Input</button>
  <input type="text" id="destination" placeholder="Transcribed text will appear here">
  <div id="pronunciation-feedback"></div>

  <script>
    let mediaRecorder;
    let audioChunks = [];

    function startVoiceInput() {
      // Check if the browser supports the Media Recorder API
      if ('MediaRecorder' in window) {
        navigator.mediaDevices.getUserMedia({ audio: true })
          .then((stream) => {
            mediaRecorder = new MediaRecorder(stream);
            mediaRecorder.addEventListener('dataavailable', (event) => {
              audioChunks.push(event.data);
            });
            mediaRecorder.addEventListener('stop', () => {
              const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
              audioChunks = [];
              sendAudioToGoogleAPI(audioBlob);
            });
            mediaRecorder.start();
          })
          .catch((error) => {
            console.error('Error accessing microphone:', error);
            alert('Unable to access microphone. Please try again.');
          });
      } else {
        alert('Your browser does not support the required features for voice recognition. Please try a different browser.');
      }
    }

    async function sendAudioToGoogleAPI(audioBlob) {
      try {
        const formData = new FormData();
        formData.append('audio', audioBlob, 'recording.webm');

        const response = await axios.post('https://speech.googleapis.com/v1/speech:recognize?key=YOUR_API_KEY', formData, {
          headers: {
            'Content-Type': 'multipart/form-data'
          }
        });

        const transcript = response.data.results[0].alternatives[0].transcript;
        document.getElementById('destination').value = transcript.trim();
        checkPronunciation(transcript);
      } catch (error) {
        console.error('Error sending audio to Google API:', error);
        const feedback = document.getElementById('pronunciation-feedback');
        feedback.textContent = 'Error: Unable to process voice input. Please try again.';
      }
    }

    function checkPronunciation(transcript) {
      // Implement your pronunciation checking logic here
      const feedback = document.getElementById('pronunciation-feedback');
      if (transcript.includes('difficult word')) {
        feedback.textContent = 'Pronunciation for "difficult word" could be improved.';
      } else {
        feedback.textContent = '';
      }
    }
  </script>
</body>
</html>
